<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>å¿«é€Ÿæ’åº Quicksort - Rust Algorithm Club</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Learn algorithms and data structures with Rust">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../../favicon.svg">
        
        
        <link rel="shortcut icon" href="../../favicon.png">
        
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        
        <link rel="stylesheet" href="../../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">Rust Algorithm Club</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ğŸ’¡ åŸºç¤æ¦‚å¿µ</li><li class="chapter-item expanded "><a href="../../concepts/asymptotic-notation/index.html">æ¼¸é€²ç¬¦è™Ÿ Asymptotic Notation</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ğŸ” æœå°‹</li><li class="chapter-item expanded "><a href="../../searching/linear_search/index.html">ç·šæ€§æœå°‹ Linear search</a></li><li class="chapter-item expanded "><a href="../../searching/binary_search/index.html">äºŒå…ƒæœå°‹ Binary search</a></li><li class="chapter-item expanded "><a href="../../searching/interpolation_search/index.html">å…§æ’æœå°‹ Interpolation search</a></li><li class="chapter-item expanded "><a href="../../searching/exponential_search/index.html">æŒ‡æ•¸æœå°‹ Exponential search</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ğŸ“š æ’åº</li><li class="chapter-item expanded affix "><li class="part-title">ç°¡å–®æ’åº</li><li class="chapter-item expanded "><a href="../../sorting/insertion_sort/index.html">æ’å…¥æ’åº Insertion sort</a></li><li class="chapter-item expanded "><a href="../../sorting/selection_sort/index.html">é¸æ“‡æ’åº Selection sort</a></li><li class="chapter-item expanded "><a href="../../sorting/bubble_sort/index.html">æ°£æ³¡æ’åº Bubble sort</a></li><li class="chapter-item expanded "><a href="../../sorting/shellsort/index.html">å¸Œçˆ¾æ’åº Shellsort</a></li><li class="chapter-item expanded affix "><li class="part-title">é«˜æ•ˆæ’åº</li><li class="chapter-item expanded "><a href="../../sorting/heapsort/index.html">å †ç©æ’åº Heapsort</a></li><li class="chapter-item expanded "><a href="../../sorting/quicksort/index.html" class="active">å¿«é€Ÿæ’åº Quicksort</a></li><li class="chapter-item expanded "><a href="../../sorting/mergesort/index.html">åˆä½µæ’åº Mergesort</a></li><li class="chapter-item expanded affix "><li class="part-title">æ··åˆæ’åº</li><li class="chapter-item expanded "><div>ğŸš§ å…§çœæ’åº Introsort</div></li><li class="chapter-item expanded "><div>ğŸš§ è‡ªé©æ‡‰åˆä½µæ’åº Timsort</div></li><li class="chapter-item expanded "><div>ğŸš§ æ¨¡å¼æ¶ˆé™¤å¿«é€Ÿæ’åº Pdqsort</div></li><li class="chapter-item expanded affix "><li class="part-title">ç‰¹æ®Šæ’åº</li><li class="chapter-item expanded "><a href="../../sorting/counting_sort/index.html">è¨ˆæ•¸æ’åº Counting sort</a></li><li class="chapter-item expanded "><a href="../../sorting/bucket_sort/index.html">æ¡¶æ’åº Bucket sort</a></li><li class="chapter-item expanded "><a href="../../sorting/radix_sort/index.html">åŸºæ•¸æ’åº Radix sort</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ğŸ  è³‡æ–™çµæ§‹</li><li class="chapter-item expanded affix "><li class="part-title">å †ç–Šèˆ‡ä½‡åˆ—</li><li class="chapter-item expanded "><a href="../../collections/stack/index.html">å †ç–Š Stack</a></li><li class="chapter-item expanded "><a href="../../collections/queue/index.html">ä½‡åˆ— Queue</a></li><li class="chapter-item expanded "><a href="../../collections/deque/index.html">é›™ç«¯ä½‡åˆ— Deque</a></li><li class="chapter-item expanded affix "><li class="part-title">éˆçµä¸²åˆ—</li><li class="chapter-item expanded "><a href="../../collections/linked_list/index.html">éˆçµä¸²åˆ—æ¦‚è¿°</a></li><li class="chapter-item expanded "><a href="../../collections/singly_linked_list/index.html">å–®å‘éˆçµä¸²åˆ— Singly linked list</a></li><li class="chapter-item expanded "><div>ğŸš§ é›™å‘éˆçµä¸²åˆ— Doubly linked list</div></li><li class="chapter-item expanded "><div>ğŸš§ å¾ªç’°éˆçµä¸²åˆ— Circular linked list</div></li><li class="chapter-item expanded affix "><li class="part-title">é—œè¯å®¹å™¨</li><li class="chapter-item expanded "><a href="../../collections/associative-container/index.html">é—œè¯å®¹å™¨æ¦‚è¿°</a></li><li class="chapter-item expanded "><a href="../../collections/hash_map/index.html">é›œæ¹Šè¡¨ Hash map</a></li><li class="chapter-item expanded "><div>ğŸš§ æœ‰åºæ˜ å°„è¡¨ Ordered map</div></li><li class="chapter-item expanded "><div>ğŸš§ å¤šé‡æ˜ å°„è¡¨ Multimap</div></li><li class="chapter-item expanded "><a href="../../collections/set/index.html">é›†åˆ Set</a></li><li class="chapter-item expanded "><a href="../../collections/bloom_filter/index.html">å¸ƒéš†éæ¿¾å™¨ Bloom filter</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">ğŸ§µ å­—ä¸²è™•ç†</li><li class="chapter-item expanded "><a href="../../hamming_distance/index.html">æ¼¢æ˜è·é›¢ Hamming distance</a></li><li class="chapter-item expanded "><a href="../../levenshtein_distance/index.html">èŠæ–‡æ–¯å¦è·é›¢ Levenshtein distance</a></li><li class="chapter-item expanded "><div>ğŸš§ æœ€é•·å…±åŒå­å­—ä¸² Longest common substring</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="../../CONTRIBUTING.html">è²¢ç»æŒ‡å—</a></li><li class="chapter-item expanded affix "><a href="../../404.html">404</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Rust Algorithm Club</h1>

                    <div class="right-buttons">
                        
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/weihanglo/rust-algorithm-club" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#å¿«é€Ÿæ’åº-quicksort" id="å¿«é€Ÿæ’åº-quicksort">å¿«é€Ÿæ’åº Quicksort</a></h1>
<p>Quicksort æ˜¯ä¸€å€‹éå¸¸ç†±é–€ä¸”æ‡‰ç”¨å»£æ³›çš„æ’åºæ³•ï¼Œç›¸å°ç°¡å–®çš„å¯¦ä½œå°±å¯é”åˆ° $O(n \log n) $ çš„å¹³å‡æ™‚é–“è¤‡é›œåº¦ã€‚é›–ç„¶æœ€å·®æ™‚é–“è¤‡é›œåº¦èˆ‡ <a href="../bubble_sort">bubble sort</a> åŒç‚º $O(n^2) $ï¼Œä½†é€™ç¨®æƒ…å½¢éå¸¸å°‘è¦‹ã€‚ç°¡å–®çš„æœ€ä½³åŒ–å¯¦ä½œä¸‹ï¼ŒQuicksort åƒ…éœ€ $O(\log n) $ çš„é¡å¤–å„²å­˜ç©ºé–“ï¼Œæ¯”å®ƒçš„ç«¶çˆ­å°æ‰‹ <a href="../mergesort">mergesort</a> ä¾†å¾—ç¯€çœã€‚éå¸¸é©åˆé‹ç”¨åœ¨çœŸå¯¦ä¸–ç•Œä¸­çš„æ’åºæ³•ã€‚</p>
<p>Quicksort åŸºæœ¬ç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¦ä½œç°¡å–®ï¼Œé€Ÿåº¦å¿«ã€‚</li>
<li><strong>ä¸ç©©å®šæ’åº</strong>ï¼šæ’åºå¾Œï¼Œç›¸åŒéµå€¼çš„å…ƒç´ ç›¸å°ä½ç½®å¯èƒ½æ”¹è®Šã€‚</li>
<li><strong>éåŸåœ°æ’åº</strong>ï¼šé™¤äº†è³‡æ–™æœ¬èº«ï¼Œä»éœ€é¡å¤–èŠ±è²»å„²å­˜ç©ºé–“ä¾†æ’åºã€‚</li>
<li><strong>åˆ†æ²»æ¼”ç®—æ³•</strong>ï¼šå°‡ä¸»å•é¡ŒåŒ–ä½œæ•¸å€‹å­å•é¡Œï¼Œå„å€‹æ“Šç ´ã€‚</li>
</ul>
<h2><a class="header" href="#æ­¥é©Ÿ" id="æ­¥é©Ÿ">æ­¥é©Ÿ</a></h2>
<p>Quicksort æ˜¯ä¸€å€‹åˆ†æ²»æ¼”ç®—æ³•ï¼ˆdivide-and-conquerï¼‰ï¼Œä¸æ–·éè¿´ä¸‹åˆ—ä¸‰å€‹æ­¥é©Ÿï¼š</p>
<ol>
<li><strong>é¸æ“‡ Pivot</strong>ï¼šåœ¨åºåˆ—ä¸­ä»»æ„é¸æ“‡ä¸€å€‹å…ƒç´ ï¼Œç¨±ç‚º <strong>Pivot</strong>ã€‚</li>
<li><strong>åˆ†å‰²åºåˆ—</strong>ï¼šå°‡åºåˆ—é‡æ–°æ’åºï¼Œåˆ†ç‚ºå…©éƒ¨åˆ†ï¼Œæ¯” pivot å° çš„å…ƒç´ ç½®æ›åˆ° pivot ä¹‹å‰ï¼Œæ¯” pivot å¤§çš„å…ƒç´ ç½®æ›åˆ° pivot ä¹‹å¾Œï¼Œè€Œ pivot æœ¬èº«æœƒåº§è½åœ¨å®ƒæœ€çµ‚çš„æ­£ç¢ºä½ç½®ã€‚</li>
<li><strong>éè¿´</strong>ï¼šåˆ†åˆ¥å°‡ã€Œæ¯” pivot å°ã€åŠã€Œæ¯” pivot å¤§ã€å…©éƒ¨åˆ†é‡è¤‡ä¸Šè¿°æ­¥é©Ÿï¼Œç›´åˆ°æ–°åºåˆ—çš„é•·åº¦å°æ–¼ç­‰æ–¼ 1ï¼Œç„¡æ³•ç¹¼çºŒåˆ†å‰²ç‚ºæ­¢ï¼Œæ­¤æ™‚æ’åºå®Œæˆã€‚</li>
</ol>
<h3><a class="header" href="#lomuto-partition-scheme" id="lomuto-partition-scheme">Lomuto partition scheme</a></h3>
<p>ç‚ºäº†é”æˆä¸Šè¿°æ¢ä»¶ï¼ŒQuicksort æœ‰è¨±å¤šä¸åŒçš„åˆ†å‰²åºåˆ—å¯¦ä½œæ–¹æ¡ˆï¼ˆpartition schemeï¼‰ï¼Œå…¶ä¸­ä»¥ Lomuto partition æœ€æ˜“ç†è§£ï¼Œå¸¸è¢«åšç‚ºæ•™æã€‚</p>
<ol>
<li>ä»¥åºåˆ—æœ€å¾Œä¸€å€‹å…ƒç´ ç•¶åš pivotã€‚</li>
<li>åˆ©ç”¨å…©å€‹æŒ‡æ¨™ <code>i</code> <code>j</code>ï¼Œå…¶ä¸­ <code>j</code> å¾é ­ç–Šä»£æ•´å€‹åºåˆ—
<ul>
<li>è‹¥æœ‰åºåˆ—ç¬¬ j å€‹å…ƒç´ å°æ–¼ pivotï¼Œå‰‡èˆ‡ç¬¬ i å€‹å…ƒç´ ç½®æ›ã€‚</li>
<li>ç¬¬ i å€‹å…ƒç´ å·²è½åœ¨å°æ–¼ pivot çš„ç¯„åœï¼Œå°‡ i æŒ‡æ¨™å¾€å¾Œç§»ä¸€å€‹ï¼Œè™•ç†ä¸‹å€‹å…ƒç´ ã€‚</li>
</ul>
</li>
<li>ç–Šä»£å®Œæˆå¾Œï¼Œå°æ–¼ pivot çš„å…ƒç´ å…¨éƒ½ç½®æ›è‡³åºåˆ—å‰ç«¯ï¼Œæ­¤æ™‚å°‡ pivot èˆ‡ç¬¬ i å€‹å…ƒç´ ç½®æ›ï¼Œpivot æœƒå‰›å¥½åœ¨æœ€çµ‚æ­£ç¢ºä½ç½®ä¸Šï¼ˆç¬¦åˆä¸ç­‰å¼ï¼‰ã€‚</li>
</ol>
<p>ASCII ç•«å‡ºä¾†çš„åˆ†å‰²åœ–å¦‚ä¸‹ï¼š</p>
<pre><code>[ values &lt;= pivot | values &gt; pivot | not checked yet | pivot ]
  low           i   i+1        j-1   j        high-1   high
</code></pre>
<ul>
<li><code>arr[low...i]</code> åŒ…å«æ‰€æœ‰å°æ–¼ç­‰æ–¼ pivot çš„å…ƒç´ ã€‚</li>
<li><code>arr[i+1...j-1]</code> åŒ…å«æ‰€æœ‰å¤§æ–¼ pivot çš„å…ƒç´ ã€‚</li>
<li><code>arr[j...high-1]</code> åŒ…å«æ‰€æœ‰å°šæœªç–Šä»£çš„å…ƒç´ ã€‚</li>
<li><code>arr[high]</code> pivot æœ¬èº«ã€‚</li>
</ul>
<h2><a class="header" href="#èªªæ˜" id="èªªæ˜">èªªæ˜</a></h2>
<p>ä»¥ Lomuto partition scheme ç‚ºä¾‹ï¼Œä½¿ç”¨ ASCII diagram è§£é‡‹ã€‚</p>
<p>çµ¦å®šä¸€å€‹åºåˆ—ï¼Œä¸¦é¸æ“‡æœ€å¾Œä¸€å€‹å…ƒç´ ä½œç‚º pivotï¼Œ<code>i</code> <code>j</code> æŒ‡æ¨™å‰‡åœ¨ç¬¬ä¸€å€‹å…ƒç´ ä½ç½®ã€‚</p>
<pre><code>                      * -&gt; pivot
[17, 20, 2, 1, 3, 21, 8]
 i
 j
</code></pre>
<p>ç¬¬ <code>j</code> å€‹å…ƒç´  17 å¤§æ–¼ pivot 8ï¼Œä¸ç½®æ›ã€‚</p>
<pre><code>17 &gt; 8, no swap
                       * -&gt; pivot
[17| 20, 2, 1, 3, 21, 8]
 i
 j
</code></pre>
<p>ç¬¬ <code>j</code> å€‹å…ƒç´  20 å¤§æ–¼ pivot 8ï¼Œä¸ç½®æ›ã€‚</p>
<pre><code>20 &gt; 8, no swap
                      * -&gt; pivot
[17, 20| 2, 1, 3, 21, 8]
 i
     j
</code></pre>
<p>ç¬¬ <code>j</code> å€‹å…ƒç´  2 å°æ–¼ pivot 8ï¼Œç½®æ› <code>i</code> <code>j</code>ã€‚<code>i</code> å¾€å¾Œä¸€å€‹ä½ç½®ã€‚</p>
<pre><code>2 &lt;= 8,
swap i, j
                      * -&gt; pivot
[2, 20, 17| 1, 3, 21, 8]
 i-&gt;i
        j
</code></pre>
<p>ç¬¬ <code>j</code> å€‹å…ƒç´  1 å°æ–¼ pivot 8ï¼Œç½®æ› <code>i</code> <code>j</code>ã€‚<code>i</code> å¾€å¾Œä¸€å€‹ä½ç½®ã€‚</p>
<pre><code>1 &lt;= 8
swap i, j
                      * -&gt; pivot
[2, 1, 17, 20| 3, 21, 8]
    i-&gt;i
            j
</code></pre>
<p>ç¬¬ <code>j</code> å€‹å…ƒç´  3 å°æ–¼ pivot 8ï¼Œç½®æ› <code>i</code> <code>j</code>ã€‚<code>i</code> å¾€å¾Œä¸€å€‹ä½ç½®ã€‚</p>
<pre><code>3 &lt;= 8
swap i, j
                      * -&gt; pivot
[2, 1, 3, 20, 17| 21, 8]
       i-&gt;i
               j
</code></pre>
<p>ç¬¬ <code>j</code> å€‹å…ƒç´  21 å¤§æ–¼ pivot 8ï¼Œä¸ç½®æ›ã€‚</p>
<pre><code>21 &gt; 8, no swap
                      * -&gt; pivot
[2, 1, 3, 20, 17, 21| 8]
           i
                   j
</code></pre>
<p>æœ€å¾Œï¼Œå°‡ pivot èˆ‡ç¬¬ <code>i</code> å€‹å…ƒç´ ç½®æ›ï¼Œæ­¤æ™‚ pivot å·²åœ¨æœ€çµ‚ä½ç½®ä¸Šï¼Œå‰é¢çš„å…ƒç´ çš†å°æ–¼ç­‰æ–¼ 8ï¼Œå…¶å¾Œçš„å…ƒç´ çš†å¤§æ–¼ 8ã€‚</p>
<pre><code>swap pivot, i
          i    &lt;-&gt;   * -&gt; pivot
[2, 1, 3, 8, 17, 21, 20]
</code></pre>
<p>é€™æ¨£å°±å®Œæˆä¸€æ¬¡çš„ partition äº†ï¼</p>
<p>ä¹‹å¾Œå†éè¿´åˆ†å‰² subarray å³å¯å®Œæˆ Quicksortã€‚</p>
<pre><code>[2, 1, 3, 8, 17, 21, 20]
 #     #     *       *
 |     |     |       |
 -------     ---------
 quicksort    quicksort
</code></pre>
<h2><a class="header" href="#æ•ˆèƒ½" id="æ•ˆèƒ½">æ•ˆèƒ½</a></h2>
<table><thead><tr><th></th><th>Complexity</th></tr></thead><tbody>
<tr><td>Worst</td><td>$O(n^2) $</td></tr>
<tr><td>Best</td><td>$O(n \log n) $</td></tr>
<tr><td>Average</td><td>$O(n \log n) $</td></tr>
<tr><td>Worst space</td><td>$O(\log n) $ or $O(n) $ auxiliary</td></tr>
</tbody></table>
<h3><a class="header" href="#time-complexity" id="time-complexity">Time complexity</a></h3>
<p>Quicksort åƒ…æœ‰ã€Œ<strong>é¸æ“‡ Pivot</strong>ã€èˆ‡ã€Œ<strong>åˆ†å‰²åºåˆ—</strong>ã€å…©æ­¥é©Ÿï¼Œä¸åŒçš„å¯¦ä½œçš„æ•ˆèƒ½å„ç•°ï¼Œä¹Ÿå½±éŸ¿ Quicksort çš„æ™‚é–“è¤‡é›œåº¦ã€‚</p>
<h4><a class="header" href="#æœ€å·®æƒ…æ³" id="æœ€å·®æƒ…æ³">æœ€å·®æƒ…æ³</a></h4>
<p>æœ€å·®çš„åˆ†å‰²åºåˆ—ç‹€æ³ç™¼ç”Ÿåœ¨æŒ‘é¸çš„ pivot ç¸½æ˜¯æœ€å¤§æˆ–æœ€å°å€¼ï¼ˆæˆ–åœ¨ Lomuto partition ä¸‹ï¼Œæ‰€æœ‰å…ƒç´ å€¼éƒ½ä¸€æ¨£ï¼‰ã€‚ç”±æ–¼ Lomuto ç¸½æ˜¯é¸æ“‡æœ€å¾Œä¸€å€‹å…ƒç´ ä½œç‚º pivotï¼Œé€™ç¨®æƒ…å½¢å¥½ç™¼æ–¼å·²æ’åºæˆ–æ¥è¿‘æ’åºå®Œæˆçš„è³‡æ–™ä¸Šã€‚</p>
<p>è€Œç•¶æ¯æ¬¡çš„ partition éƒ½æ˜¯æœ€ä¸å¹³è¡¡çš„åˆ†å‰²åºåˆ—ï¼Œå°±æœƒç”¢ç”Ÿæœ€å·®æ™‚é–“è¤‡é›œåº¦çš„ç‹€æ³ã€‚éè¿´åœ¨åºåˆ—é•·åº¦ç­‰æ–¼ 1 æ™‚åœæ­¢ï¼Œå› æ­¤æ•´å€‹æ’åºæ³•çš„ call stack éœ€è¦ $n - 1 $ çš„åµŒå¥—éè¿´å‘¼å«ï¼ˆnested callï¼‰ï¼›è€Œç¬¬ $i $ æ¬¡åˆ†å‰²æœƒåŸ·è¡Œ $n - i $ æ¬¡åŸºæœ¬æ“ä½œï¼ˆ $O(n) $ï¼‰ï¼Œæ‰€ä»¥ç¸½å…±éœ€åŸ·è¡Œ</p>
<p>$$\sum_{i = 0}^n (n - i) = n^2 - \frac{n(n + 1)}{2}$$</p>
<p>æ¬¡åŸºæœ¬æ“ä½œï¼Œæœ€å·®æ™‚é–“è¤‡é›œåº¦ç‚º $O(n^2) $ã€‚</p>
<h4><a class="header" href="#æœ€ä½³æƒ…æ³" id="æœ€ä½³æƒ…æ³">æœ€ä½³æƒ…æ³</a></h4>
<p>æ—¢ç„¶æœ€å·®æƒ…æ³ç™¼ç”Ÿåœ¨ pivot ç¸½é¸åˆ°æœ€å¤§æˆ–æœ€å°å€¼ï¼Œåä¹‹ï¼Œæœ€ä½³æƒ…æ³å‰‡ç™¼ç”Ÿåœ¨æ¯æ¬¡ pivot éƒ½å¯ä»¥é †åˆ©é¸åˆ°åºåˆ—çš„ä¸­ä½æ•¸ï¼ˆmedianï¼‰ï¼Œå¦‚æ­¤ä¸€ä¾†ï¼Œæ¯æ¬¡éè¿´åˆ†å‰²çš„åºåˆ—é•·åº¦éƒ½æœƒæ¸›åŠï¼ˆ $n / 2 $ï¼‰ï¼Œcall stack çš„åµŒå¥—éè¿´ç¸½å…±éœ€è¦ $2 \log_2{n} $ æ¬¡ï¼Œåºåˆ—çš„é•·åº¦å°±æœƒæ¸›è‡³ 1ï¼Œè€Œæ¯æ¬¡åˆ†å‰²åŒæ¨£æœ‰ $O(n) $ çš„è¤‡é›œåº¦ï¼Œå› æ­¤æœ€ä½³æƒ…æ³ç‚ºï¼š</p>
<p>$$O(n \cdot 2 \log_2{n}) = O(n \log n)$$</p>
<h3><a class="header" href="#space-complexity" id="space-complexity">Space complexity</a></h3>
<p>Quicksort çš„ç©ºé–“è¤‡é›œåº¦å–æ±ºæ–¼å¯¦ä½œç´°ç¯€ï¼Œç”±æ–¼<strong>åˆ†å‰²åºåˆ—</strong>æ­¥é©Ÿéœ€ $O(1) $ çš„ç©ºé–“è¤‡é›œåº¦ï¼Œå› æ­¤åƒ…éœ€åˆ†æéè¿´å¼æœƒåœ¨ call stack ç”¢ç”Ÿå¤šå°‘ stack frame å³å¯ã€‚</p>
<p><a href="#%E6%9C%80%E5%B7%AE%E6%83%85%E6%B3%81">å‰é¢æåŠ</a>ï¼Œæœ€ naÃ¯ve çš„ Lomuto partition æœ€ç³Ÿç³•çš„æƒ…å½¢ä¸‹ï¼Œæœƒç”¢ç”Ÿ $n - 1 $ å€‹åµŒå¥—éè¿´ï¼Œä¹Ÿå°±æ˜¯éœ€é¡å¤–ä½¿ç”¨ $O(n) $ çš„ç©ºé–“å„²å­˜ call stack frameï¼Œä½†åªè¦ compiler æœ‰æ”¯æ´<a href="https://en.wikipedia.org/wiki/Tail_call">å°¾ç«¯å‘¼å«</a>æœ€ä½³åŒ–ï¼ˆtail-call optimizationï¼ŒTCOï¼‰ï¼ŒQuicksort å¾ˆå®¹æ˜“æœ€ä½³åŒ–è‡³ $O(\log n) $ã€‚</p>
<h2><a class="header" href="#å¯¦ä½œ" id="å¯¦ä½œ">å¯¦ä½œ</a></h2>
<p>Quicksort å¯¦ä½œä¸»è¦åˆ†ç‚ºå…©éƒ¨åˆ†ï¼šéè¿´ï¼Œä»¥åŠåˆ†å‰²åºåˆ—ï¼ˆpartitionï¼‰ã€‚</p>
<h3><a class="header" href="#recursion" id="recursion">Recursion</a></h3>
<p>éè¿´å‡½å¼æœ¬èº«å¯¦ä½œéå¸¸ç°¡å–®ï¼Œåˆ†åˆ¥å°‡å°æ–¼ pivot èˆ‡å¤§æ–¼ pivot å…©éƒ¨åˆ†éè¿´å‘¼å«è‡ªèº«å³å¯ã€‚</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>/// Recursion helper
fn quicksort_helper(arr: &amp;mut [i32], lo: isize, hi: isize) {
    if lo &lt;= hi {                               // 1
        let pivot = partition(arr, lo, hi);     // 2
        quicksort_helper(arr, lo, pivot - 1);   // 3
        quicksort_helper(arr, pivot + 1, hi);   // 4
    }
}
<span class="boring">}
</span></code></pre></pre>
<ol>
<li>åˆ©ç”¨ <code>lo</code> èˆ‡ <code>hi</code> å…©å€‹æŒ‡æ¨™æ±ºå®šæ¯æ¬¡çš„éè¿´ç¯„åœï¼Œä¸¦åœ¨ <code>lo</code> å¤§æ–¼ <code>hi</code> æ™‚åœæ­¢éè¿´ï¼Œé¿å…é‡è¤‡åˆ†å‰²åºåˆ—ã€‚</li>
<li>åˆ†å‰²åºåˆ—æ­¥é©Ÿï¼Œå›å‚³è©²åºåˆ—ç¯„åœå…§ pivot çš„ indexã€‚</li>
<li>éè¿´å°æ–¼ pivot çš„éƒ¨åˆ†ã€‚</li>
<li>éè¿´å¤§æ–¼ pivot çš„éƒ¨åˆ†ã€‚</li>
</ol>
<blockquote>
<p>é€™é‚Šæ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ï¼Œ<code>lo</code> å’Œ <code>hi</code> å…©å€‹æŒ‡æ¨™çš„å‹åˆ¥ç‚º <code>isize</code>ï¼Œå› ç‚ºç•¶ pivot å¯èƒ½ç‚º 0ï¼Œåœ¨ç¬¬ä¸‰æ­¥é©Ÿ - 1 æ™‚æœƒç”¢ç”Ÿå‹åˆ¥éŒ¯èª¤ï¼Œæ•…ç‚ºä¹‹ã€‚æœ‰ä»»ä½•æ›´å¥½çš„å¯«æ³•æ­¡è¿æä¾›ï¼</p>
</blockquote>
<p>ç”±æ–¼å¤–éƒ¨ä¸éœ€çŸ¥é“æ’åºæ³•å¯¦ä½œç´°ç¯€ï¼Œæˆ‘å€‘å°‡å‡½å¼å‘½åç‚º <code>quicksort_helper</code> ï¼Œå°å¤–å†å¤šå°è£ä¸€å±¤ä¸»å‡½å¼ <code>quicksort_lomuto</code>ï¼Œå¯¦ä½œå¦‚ä¸‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn quicksort_lomuto(arr: &amp;mut [i32]) {
    let hi = arr.len() as isize - 1;
    quicksort_helper(arr, 0, hi);
}
<span class="boring">}
</span></code></pre></pre>
<h3><a class="header" href="#partitioning" id="partitioning">Partitioning</a></h3>
<p>ä¸€èˆ¬ä¾†èªªï¼Œåˆ†å‰²åºåˆ—çš„å¯¦ä½œæœ‰ä¸‹åˆ—å…©å€‹æ­¥é©Ÿï¼š</p>
<ul>
<li>é¸æ“‡ pivot</li>
<li>éæ­·åºåˆ—ç½®æ›å…ƒç´ </li>
</ul>
<p>æˆ‘å€‘ä»¥ Lomuto scheme å¯¦ä½œ partitionã€‚</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn partition(arr: &amp;mut [i32], lo: isize, hi: isize) -&gt; isize {
    // -- Determine the pivot --
    // In Lomuto parition scheme,
    // the latest element is always chosen as the pivot.
    let pivot = arr[hi as usize];               // 1
    let mut i = lo;

    // -- Swap elements --
    for j in lo..hi {                           // 2
        if arr[j as usize] &lt; pivot {
            arr.swap(i as usize, j as usize);
            i += 1;                             // 3
        }
    }
    // Swap pivot to the middle of two piles.
    arr.swap(i as usize, hi as usize);          // 4
    i // Return the final index of the pivot
}
<span class="boring">}
</span></code></pre></pre>
<ol>
<li>Lomuto scheme é¸æ“‡ pivot çš„æ–¹å¼å¾ˆç›´æ¥ï¼Œå°±æ˜¯é¸æ“‡æœ€å¾Œä¸€å€‹å…ƒç´ ã€‚</li>
<li>åˆ©ç”¨ <code>i</code>ã€<code>j</code> å…©å€‹æŒ‡æ¨™ç–Šä»£æŒ‡å®šçš„åºåˆ—ç¯„åœï¼Œè‹¥ç¬¬ j å€‹å€¼å°æ–¼ pivot æ™‚ï¼Œå‰‡æ–¼ç¬¬ i å€‹å…ƒç´ ç½®æ›ã€‚</li>
<li><code>i</code> æŒ‡æ¨™åŠ ä¸€ï¼Œç¹¼çºŒè™•ç†ä¸‹å€‹å…ƒç´ ã€‚</li>
<li>æœ€å¾Œç½®æ›ç¬¬ i å€‹å…ƒç´ æ–¼ pivotï¼Œæ­¤æ™‚ pivot å·²è½åœ¨æœ€çµ‚æ­£ç¢ºçš„ä½ç½®ã€‚</li>
</ol>
<h2><a class="header" href="#æœ€ä½³åŒ–èˆ‡è®Šå½¢" id="æœ€ä½³åŒ–èˆ‡è®Šå½¢">æœ€ä½³åŒ–èˆ‡è®Šå½¢</a></h2>
<p>Quicksort æœ‰æ•¸å€‹æ–¹å‘å¯ä»¥æ¢è¨æœ€ä½³åŒ–ï¼š</p>
<ul>
<li><a href="#%E9%99%8D%E4%BD%8E%E9%A1%8D%E5%A4%96%E7%A9%BA%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6">é™ä½é¡å¤–ç©ºé–“è¤‡é›œåº¦</a></li>
<li><a href="#%E9%81%B8%E6%93%87-pivot-%E7%9A%84%E6%96%B9%E6%B3%95">é¸æ“‡ Pivot çš„æ–¹æ³•</a></li>
<li><a href="#%E5%B0%8D%E4%BB%98%E9%87%8D%E8%A4%87%E7%9A%84%E5%85%83%E7%B4%A0">å°ä»˜é‡è¤‡çš„å…ƒç´ </a></li>
<li><a href="%E9%81%B8%E6%93%87%E4%B8%8D%E5%90%8C%E7%9A%84%E5%88%86%E5%89%B2%E6%96%B9%E6%A1%88">é¸æ“‡ä¸åŒçš„åˆ†å‰²æ–¹æ¡ˆ</a></li>
</ul>
<h3><a class="header" href="#é™ä½é¡å¤–ç©ºé–“è¤‡é›œåº¦" id="é™ä½é¡å¤–ç©ºé–“è¤‡é›œåº¦">é™ä½é¡å¤–ç©ºé–“è¤‡é›œåº¦</a></h3>
<p>å‰è¿°æåˆ°æœ€ä½³æƒ…å½¢ä¸‹ï¼ˆæ¯æ¬¡ pivot éƒ½é¸åˆ°ä¸­ä½æ•¸ï¼‰ï¼Œåƒ…éœ€ $\log n $ å€‹åµŒå¥—éè¿´ï¼Œé¡å¤–ç©ºé–“è¤‡é›œåº¦åƒ…éœ€ $O(\log n) $ã€‚
å€˜è‹¥ç·¨è­¯å™¨æœ‰å¯¦ä½œ <strong>å°¾ç«¯å‘¼å«æœ€ä½³åŒ–</strong>ï¼ŒQuicksort å¯ä»¥é”åˆ° $O(\log n) $ å°æ•¸ç´šåˆ¥çš„é¡å¤–ç©ºé–“ä½¿ç”¨ã€‚</p>
<p>å¯¦ä½œå°¾ç«¯å‘¼å«æœ€ä½³åŒ–çš„æ€è·¯å¾ˆç°¡å–®ï¼Œã€Œ<strong>å…ˆéè¿´è¼ƒå°‘å…ƒç´ çš„éƒ¨åˆ†ï¼Œå†åˆ©ç”¨ tall-call éè¿´å¦ä¸€éƒ¨åˆ†</strong>ã€ï¼Œå¦‚æ­¤ä»¥ä¾†ï¼Œè¼ƒå¤šå…ƒç´ çš„éè¿´å‰‡æœƒç›´æ¥è¢«ç·¨è­¯å™¨å±•é–‹ï¼Œæ¶ˆå»éè¿´æ™‚éœ€è¦çš„ call stack ç©ºé–“ã€‚å‰©ä¸‹è¼ƒå°‘å…ƒç´ çš„éƒ¨åˆ†ï¼Œå‰‡èˆ‡æœ€ä½³æƒ…å½¢ç›¸åŒï¼Œæœ€å¤šåƒ…éœ€ $\log n $ æ¬¡åµŒå¥—éè¿´ã€‚</p>
<p>ç°¡å–®å¯¦ä½œå¦‚ä¸‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn quicksort_helper_optimized(arr: &amp;mut [i32], lo: isize, hi: isize) {
    if lo &lt;= hi {
        let pivot = partition(arr, lo, hi);
        if pivot - lo &lt; hi - pivot {                      // 1
          quicksort_helper_optimized(arr, lo, pivot - 1);
          quicksort_helper_optimized(arr, pivot + 1, hi); // 2
        } else {
          quicksort_helper_optimized(arr, pivot + 1, hi);
          quicksort_helper_optimized(arr, lo, pivot - 1); // 3
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<ol>
<li>èªªç©¿äº†å°±åªæœ‰é€™å€‹åˆ¤æ–·å¼ï¼Œæ±ºå®šå“ªéƒ¨åˆ†è©²å…ˆéè¿´è€Œå·²ã€‚</li>
<li>é€™æ˜¯ä¸€å€‹å°¾ç«¯å‘¼å«ï¼Œæœƒå±•é–‹ã€‚</li>
<li>é€™ä¹Ÿæ˜¯ä¸€å€‹å°¾ç«¯å‘¼å«ã€‚</li>
</ol>
<p>å¯¦éš›ä¸Šï¼Œæˆªè‡³ 2018.2ï¼Œ<a href="https://github.com/rust-lang/rfcs/pull/1888">Rust Core Team æ±ºå®šæš«ç·© TCO çš„å¯¦ä½œ</a>ï¼Œç›®å‰ Rust ä¸¦æ²’æœ‰æ”¯æ´ TCOã€‚ä½†æˆ‘å€‘é‚„æ˜¯å¯ä»¥æ‰‹å‹•å¯¦ä½œ TCOï¼Œæ¸›å°‘ call stackã€‚</p>
<p>æˆ‘å€‘å…ˆæŠŠåŸå§‹çš„ lomuto partition å¯¦ä½œæ”¹æˆæ‰‹å‹• TCO ç‰ˆæœ¬ã€‚åˆ©ç”¨ <code>while</code> loopï¼Œå°‡ <code>lo</code> æ›¿æ›æˆä¸‹ä¸€å€‹éè¿´çš„å¼•æ•¸ï¼Œæ¸›å°‘éƒ¨åˆ†çš„ call stackã€‚</p>
<pre><code class="language-diff">- fn quicksort_helper(arr: &amp;mut [i32], lo: isize, hi: isize) {
+ fn quicksort_helper_manual_tco(arr: &amp;mut [i32], mut lo: isize, mut hi: isize) {
-     if lo &lt;= hi {
+     while lo &lt; hi {
          let pivot = partition(arr, lo, hi);
-         quicksort_helper(arr, lo, pivot - 1);
-         quicksort_helper(arr, pivot + 1, hi);
+         quicksort_helper_manual_tco(arr, lo, pivot - 1);
+         lo = pivot + 1;
      }
  }
</code></pre>
<p>å†ä¾†ï¼Œé¸æ“‡æ€§éè¿´è¼ƒå°çš„éƒ¨åˆ†ã€‚Iterative ç‰ˆæœ¬çš„å°¾ç«¯å‘¼å«æ¶ˆé™¤ï¼ˆtail-call eliminateï¼‰å°±åšå®Œäº†ï¼</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn quicksort_helper_manual_tco(arr: &amp;mut [i32], mut lo: isize, mut hi: isize) {
    while lo &lt; hi {
        let pivot = partition(arr, lo, hi);
        if pivot - lo &lt; hi - pivot {
            quicksort_helper_manual_tco(arr, lo, pivot - 1);
            lo = pivot + 1;
        } else {
            quicksort_helper_manual_tco(arr, pivot + 1, hi);
            hi = pivot - 1;
        }
    }
}
<span class="boring">}
</span></code></pre></pre>
<h3><a class="header" href="#é¸æ“‡-pivot-çš„æ–¹æ³•" id="é¸æ“‡-pivot-çš„æ–¹æ³•">é¸æ“‡ Pivot çš„æ–¹æ³•</a></h3>
<p>é¸æ“‡ pivot çš„æ–¹æ³•å¤§è‡´ä¸Šæœ‰ä»¥ä¸‹å¹¾ç¨®ï¼š</p>
<ul>
<li>ç¸½æ˜¯é¸æ“‡æœ€å¾Œä¸€å€‹å…ƒç´ ã€‚</li>
<li>ç¸½æ˜¯é¸æ“‡ç¬¬ä¸€å€‹å…ƒç´ ã€‚</li>
<li>é¸æ“‡ç‰¹å®šä½ç½®ï¼ˆå¦‚ä¸­ä½æ•¸ï¼‰çš„å…ƒç´ ã€‚</li>
<li>éš¨æ©Ÿé¸æ“‡ä»»æ„å…ƒç´ ã€‚</li>
</ul>
<p>é¸æ“‡ç¬¬ä¸€å€‹æˆ–æœ€å¾Œä¸€å€‹å…ƒç´ æœƒå°åºåˆ—å·²ç¶“æ¥è¿‘æ’åºå®Œæˆæˆ–ç›¸åæ’åºï¼Œé€ æˆ $O(n^2) $ æœ€å£çš„æ™‚é–“è¤‡é›œåº¦ã€‚éš¨æ©Ÿæˆ–é¸æ“‡ç‰¹å®šä½ç½®çš„æ–¹æ³•è¼ƒèƒ½é¿å…é€™ç¨®æƒ…æ³ï¼Œä½†å¯¦ä½œä¸Šè¼ƒå›°é›£ã€‚</p>
<p>é™¤äº†é¸æ“‡ pivot çš„æ–¹æ³•ï¼Œè¿‘å¹¾å¹´ä¾†å¤š pivotï¼ˆmulti-pivotï¼‰Quicksort ä¹Ÿæ„ˆè¶¨æµè¡Œï¼Œå¯ä»¥æ¸›å°‘ 20% çš„å…ƒç´ ç½®æ›ã€‚ç›¸é—œçš„è¨è«–èˆ‡è­‰æ˜å¯ä»¥åƒè€ƒ<a href="https://cs.stanford.edu/%7Erishig/courses/ref/l11a.pdf">é€™ç¯‡æ–‡ç« </a>ã€‚</p>
<h3><a class="header" href="#å°ä»˜é‡è¤‡çš„å…ƒç´ " id="å°ä»˜é‡è¤‡çš„å…ƒç´ ">å°ä»˜é‡è¤‡çš„å…ƒç´ </a></h3>
<p>è‹¥è¼¸å…¥åºåˆ—æœ‰è¨±å¤šé‡è¤‡çš„å…ƒç´ ï¼Œä½¿ç”¨åŸæœ¬ Lomuto scheme å¯¦ä½œçš„ Quicksort ä»ç„¶æœƒæ¯”è¼ƒç½®æ›ç­‰æ–¼ pivot çš„æ‰€æœ‰å…ƒç´ ã€‚3-way partition scheme å°±æ˜¯å°‡åºåˆ—å¤šåˆ†å‡ºã€Œç­‰æ–¼ pivotã€éƒ¨åˆ†ï¼Œæ¸›å°‘é‡è¤‡ç½®æ›ç›¸ç­‰å…ƒç´ çš„æ’åºæ³•ã€‚</p>
<pre><code>[ values &lt; pivot | values == pivot | value &gt; pivot ]
</code></pre>
<p>é€šå¸¸æ˜¯ä½¿ç”¨è‘—åçš„ <a href="https://en.wikipedia.org/wiki/Dutch_national_flag_problem">Dutch national flag algorithm</a> ä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚å¯¦ä½œä¸Šå’Œ Lomuto éå¸¸é¡ä¼¼ã€‚</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn partition(arr: &amp;mut [i32], lo: isize, hi: isize) -&gt; (isize, isize) {
    let pivot = arr[hi as usize];
    let mut i = lo;         // smaller
    let mut j = lo;         // equal
    let mut k = hi;         // large

    while j &lt;= k {
        if arr[j as usize] &lt; pivot {
            arr.swap(i as usize, j as usize);
            i += 1;
            j += 1;
        } else if arr[j as usize] &gt; pivot {
            arr.swap(k as usize, j as usize);
            k -= 1;
        } else {
            // No swap when identicial.
            j += 1;
        }
    }

    // Return smaller and larger pointer to avoid iterate duplicate elements.
    (i, k)
}
<span class="boring">}
</span></code></pre></pre>
<h3><a class="header" href="#é¸æ“‡ä¸åŒçš„åˆ†å‰²æ–¹æ¡ˆ" id="é¸æ“‡ä¸åŒçš„åˆ†å‰²æ–¹æ¡ˆ">é¸æ“‡ä¸åŒçš„åˆ†å‰²æ–¹æ¡ˆ</a></h3>
<p>ä¸åŒçš„åˆ†å‰²æ–¹æ¡ˆæœ‰è‘—ä¸åŒçš„æ‡‰ç”¨å ´æ™¯ï¼Œå¦‚ä¸Šè¿°çš„ 3-way scheme å°±é©åˆé‡è¤‡å…ƒç´ å¤šçš„åºåˆ—ã€‚é€™è£¡å†å¤šä»‹ç´¹å¦ä¸€å€‹å¸¸è¦‹çš„åˆ†å‰²å¯¦ä½œæ–¹æ¡ˆ Hoare partitionï¼Œæ˜¯ Quicksort ç™¼æ˜é€™ Hoare è‡ªå·±æå‡ºçš„åˆ†å‰²æ³•ï¼ŒRust å¯¦ä½œæ¼”ç®—æ³•å¦‚ä¸‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn partition(arr: &amp;mut [i32], lo: usize, hi: usize) -&gt; usize {
    let pivot = arr[lo];
    let mut i = lo;
    let mut j = hi;

    loop {
        // Find element &gt;= pivot from leftmost element.
        while arr[i] &lt; pivot {                            // 1
            i += 1;
        }
        // Find element &lt;= pivot from rightmost element.
        while arr[j] &gt; pivot {                            // 2
            j -= 1;
        }
        if i &gt;= j {
            return j;
        }
        // Two elements are misplaced, swap them.
        arr.swap(i, j);                                   // 3
        i += 1;
        j -= 1;
    }
}
<span class="boring">}
</span></code></pre></pre>
<ol>
<li>å¾æœ€å·¦é‚Šé–‹å§‹æ‰¾æ¯” pivot å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ ã€‚</li>
<li>å¾æœ€å³é‚Šé–‹å§‹æ‰¾æ¯” pivot å°æˆ–ç›¸ç­‰çš„å…ƒç´ ã€‚</li>
<li>è‹¥æ‰¾åˆ°é€™å…©å€‹å…ƒç´ ï¼Œç½®æ›ä¹‹ï¼Œä»¥ç¬¦åˆå°æ–¼ pivot åœ¨å‰ï¼Œå¤§æ–¼ pivot åœ¨å¾Œçš„åˆ†å‰²æº–å‰‡ã€‚</li>
</ol>
<h2><a class="header" href="#åƒè€ƒè³‡æ–™" id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Quicksort">Wiki: Quicksort</a></li>
<li><a href="https://algs4.cs.princeton.edu/23quicksort/">Algorithms, 4th Edition by R. Sedgewick and K. Wayne</a></li>
<li><a href="https://www.geeksforgeeks.org/quick-sort/">GeeksForGeeks: QuickSort</a></li>
<li><a href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Quicksort">Swift Algorithm Club: Quicksort</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../sorting/heapsort/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../sorting/mergesort/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../sorting/heapsort/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../sorting/mergesort/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        
        <script src="../../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        

        
        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../../theme/custom.js"></script>
        

        

    </body>
</html>
